<!DOCTYPE html>
<!-- saved from url=(0151)https://bildungsportal.sachsen.de/opal/g/PEEK_VIEW_WRAPPER-%2D32364462083-%2D1632450564633196003-%2D88800632029426_global/tutorial_websockets/chat.html -->
<html class="gr__bildungsportal_sachsen_de"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
	<title>WebSocket Client</title>
	<style>
		#output {
			border: solid 1px #000;
			padding: 5px;
		}
	</style>
</head>
<body data-gr-c-s-loaded="true" cz-shortcut-listen="true">

<form id="form">
	<input type="text" id="message">
	<button type="submit">Send</button>
</form>

<hr>
<div id="output"></div>

<script type="text/javascript">
	var inputBox = document.getElementById("message");
	var output = document.getElementById("output");
	var form = document.getElementById("form");

	try {
		var host = "ws://localhost:3000/stuff";
		console.log("Host:", host);

		//Open up a WebSocket connection named s 
		const s = new WebSocket(host);

		s.onopen = function (e) {
			console.log('socket is opened');
		};

		s.onclose = function (e) {
			console.log('socket is closed');
		};

		s.onmessage = function (e) {
			const newMessage = document.createElement('div');
			newMessage.innerText = e['data'];
			output.append(newMessage)
		};

		s.onerror = function (e) {
			console.log("Socket error:", e);
		};

		form.addEventListener('submit', (ev) => {
			ev.preventDefault();
			ev.stopPropagation();

			const data = inputBox.value;
			s.send(data);
		})
	
	} catch (ex) {
		console.log("Socket exception:", ex);
	}

	//Send the data
	
</script>



</body></html>